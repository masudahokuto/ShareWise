<%= form_with model: @post, local: true do |form| %>
  <div class="field">
    <%= form.label :body %>
    <%= form.text_area :body %>
  </div>

  <div id="image_fields">
    <div class="field">
      <%= form.label :images, "Images" %>
      <%= form.file_field :images, multiple: true %>
    </div>
  </div>

  <button type="button" id="add_image_button">Add more images</button>

  <div class="actions">
    <%= form.submit "Create Post" %>
  </div>
<% end %>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const addImageButton = document.getElementById('add_image_button');
    const imageFields = document.getElementById('image_fields');

    addImageButton.addEventListener('click', function() {
      const newField = document.createElement('div');
      newField.classList.add('field');
      newField.innerHTML = `<input type="file" name="post[images][]" multiple="multiple" />`;
      imageFields.appendChild(newField);
    });
  });
</script>

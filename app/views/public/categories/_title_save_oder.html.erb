<style>
  tbody tr:nth-child(even) {
    background-color: #007bff29; /* 偶数行の背景色 */
  }
  tbody tr:nth-child(odd) {
    background-color: #ffffff; /* 奇数行の背景色 */
  }

  .table th, .table td {
    vertical-align: middle;
  }

  .icon-shadow {
    color: #ffd700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  }

  .full-link {
    display: block;
    text-decoration: none !important;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    height: 100%;
    width: 100%;
    font-weight: bold;
    box-sizing: border-box;
  }

  .link-cell {
    padding: 0;
    border: none;
    vertical-align: middle;
  }

  .link-cell:hover {
    background-color: #f0e68c;  /* ホバー時の背景色 (例として薄い黄色) */
    transition: background-color 0.3s ease;  /* スムーズな色の変化 */
  }
</style>

<table class="table ">
  <thead>
    <tr>
      <th style="background-color: #d3d3d3">もくじ名</th>
      <th style="background-color: #d3d3d3">保存日</th>
      <th style="background-color: #d3d3d3"></th>
      <th style="background-color: #d3d3d3"></th>
      <th style="background-color: #d3d3d3">もくじ名</th>
      <th style="background-color: #d3d3d3">保存日</th>
      <th style="background-color: #d3d3d3"></th>
      <th style="background-color: #d3d3d3"></th>
    </tr>
  </thead>

  <tbody>
    <% sorted_titles.each_slice(2) do |slice| %>
      <tr>
        <% slice.each do |title| %>
          <td class="link-cell">
            <span id="title-name-<%= title.id %>">
              <%= link_to category_title_path(category, title), class: 'full-link d-flex align-items-center' do %>
                <i class="fa-solid fa-book mr-3 icon-shadow" style="color: #8b4513;"></i>
                <%= title.title_name %>
              <% end %>
            </span>
            <span id="title-edit-form-<%= title.id %>" style="display: none;">
              <%= form_with(model: title, url: category_title_path(category, title), method: :patch, remote: true, html: { id: "edit-form-#{title.id}" }) do |f| %>
                <%= f.text_field :title_name, value: title.title_name %>
                <%= f.submit '保存', class: 'btn btn-primary btn-sm' %>
              <% end %>
            </span>
          </td>
          <td>
            <%= title.created_at.in_time_zone("Tokyo").strftime("%Y/%m/%d %H:%M") %>
          </td>
          <td>
            <button class="btn btn-success btn-sm edit-btn" data-title-id="<%= title.id %>">編集</button>
          </td>
          <td>
            <%= link_to '削除', category_title_path(category, title), method: :delete, data: { confirm: '中身も全て消えてしまいますが本当に削除しますか？' }, class: 'full-link', style: 'color: red;' %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<script>
  $(document).on('turbolinks:load', function() {
    window.toggleEditForm = function(titleId) {
      $('#title-name-' + titleId).toggle();
      $('#title-edit-form-' + titleId).toggle();
    };
    $(document).on('click', '.edit-btn', function() {
      var titleId = $(this).data('title-id');
      toggleEditForm(titleId);
    });
    $(document).on('ajax:success', 'form[id^="edit-form-"]', function(event) {
      var [data, status, xhr] = event.detail;
      var form = $(this);
      var titleId = form.attr('id').replace('edit-form-', '');
      $('#title-name-' + titleId).text(form.find('input[name="title_name"]').val());
      toggleEditForm(titleId); // フォームを隠す
    });
    $(document).on('ajax:error', 'form[id^="edit-form-"]', function(event) {
    });
  });
</script>